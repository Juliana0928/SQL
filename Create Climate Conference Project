Climate Conference Project
Database: https://www.db-fiddle.com/f/pxMci1sLL945KHKYvpe9W6/1

-- 1. Show all members (vips) together with the hotel where they have a reservation, if any. Members without a reservation should still appear in the result.

SELECT a.member_id, a.first_name Name, a.last_name, c.hotel_name Hotel
FROM vips a
LEFT JOIN reservations AS b
ON a.member_id = b.member_id
LEFT JOIN hotels c
ON b.hotel = c.hotel_id;

-- 2. List the first name, last name, and institution (association) of all members who confirmed attendance at the dinner (dinner_rsvp = 1) and the hotel they are staying at.

SELECT a.member_id, a.first_name Name, a.last_name, c.hotel_name Hotel,a.association
FROM vips a
JOIN reservations AS b
ON a.member_id = b.member_id
LEFT JOIN hotels c
ON b.hotel = c.hotel_id
WHERE b.dinner_rsvp = 1;

-- 3. Return the memberâ€™s full name, the name of the event they are attending, and the hotel Only if they made a reservation.

SELECT a.member_id, a.first_name, a.last_name, c.hotel_name Hotel,d.event_name
FROM vips a
JOIN reservations AS b
ON a.member_id = b.member_id
JOIN hotels c
ON b.hotel = c.hotel_id
LEFT JOIN events d
ON a.event = d.event_id;


-- 4.Find the members who belong to the oldest association

SELECT *
FROM vips
WHERE member_since =(SELECT MIN(member_since) Oldest_association FROM vips);

-- 5.Show the names of members along with the names of the people they provide feedback to

SELECT a.first_name Name, b.first_name provides_feedback_to
FROM vips a
JOIN vips b
ON a.provides_feedback_to = b.member_id;

--6. List all hotels with the number of members staying in each, also showing members with no hotel.

SELECT COUNT(a.member_id) Member_Count,
		(CASE WHEN c.hotel_name IS NULL
          THEN "No hotel"
          ELSE c.hotel_name
        END) Hotel
FROM vips a
LEFT JOIN reservations AS b
ON a.member_id = b.member_id
LEFT JOIN hotels c
ON b.hotel = c.hotel_id
GROUP BY Hotel;
